import time
import math
from cosmic import CosmicUnicorn
from picographics import PicoGraphics, DISPLAY_COSMIC_UNICORN as DISPLAY

'''
Displays some text, gradients and colours and demonstrates button use.

You can adjust the brightness with LUX + and -.
'''

cu = CosmicUnicorn()
graphics = PicoGraphics(DISPLAY)

width = CosmicUnicorn.WIDTH
height = CosmicUnicorn.HEIGHT

# BITMAP 2x5 FONT
# ASCII Character Set 
bitmapFont2x5 = [
        '0000000000', #Space
        '0101010001', #!
        '0000000000', #"
        '0000000000', ##
        '0000000000', #$
        '0000000000', #%
        '0000000000', #&
        '0100000000', #'
        '0000000000', #(
        '0000000000', #)
        '0000000000', #*
        '0000000000', #+
        '0000010110', #,
        '0000110000', #-
        '0000000010', #.
        '0000000000', #/
        '1111111111', #0
        '0101010101', #1
        '1101111011', #2
        '1101110111', #3
        '1010110101', #4
        '1110110111', #5
        '1010111111', #6
        '1101010101', #7
        '1111001111', #8
        '1111110101', #9
        '0001000100', #:
        '0001000110', #;
        '0001100100', #<
        '0011001100', #=
        '0010011000', #>
        '1101111000', #?
        '0000000000', #@
        '0000000000', #A
        '0000000000', #B
        '0000000000', #C
        '0000000000', #D
        '0000000000', #E
        '0000000000', #F
        '0000000000', #G
        '0000000000', #H
        '0000000000', #I
        '0000000000', #J
        '0000000000', #K
        '0000000000', #L
        '0000000000', #M
        '0000000000', #N
        '0000000000', #O
        '0000000000', #P
        '0000000000', #Q
        '0000000000', #R
        '0000000000', #S
        '0000000000', #T
        '0000000000', #U
        '0000000000', #V
        '0000000000', #W
        '0000000000', #X
        '0000000000', #Y
        '0000000000', #Z
        '0000000000', #[
        '0000000000', #\
        '0000000000', #]
        '0000000000', #^
        '0000000000', #_
        '0000000000', #`
        '0000000000', #a
        '0000000000', #b
        '0000000000', #c
        '0000000000', #d
        '0000000000', #e
        '0000000000', #f
        '0000000000', #g
        '0000000000', #h
        '0000000000', #i
        '0000000000', #j
        '0000000000', #k
        '0000000000', #l
        '0000000000', #m
        '0000000000', #n
        '0000000000', #o
        '0000000000', #p
        '0000000000', #q
        '0000000000', #r
        '0000000000', #s
        '0000000000', #t
        '0000000000', #u
        '0000000000', #v
        '0000000000', #w
        '0000000000', #x
        '0000000000', #y
        '0000000000', #z
        '0000000000', #{
        '0000000000', #|
        '0000000000', #}
        '0000000000' #}~
]

# BITMAP 3x5 FONT
# ASCII Character Set 
bitmapFont3x5 = [
        '000000000000000', #Space
        '000000000000000', #!
        '000000000000000', #"
        '000000000000000', ##
        '000000000000000', #$
        '000000000000000', #%
        '000000000000000', #&
        '000000000000000', #'
        '000000000000000', #(
        '000000000000000', #)
        '000000000000000', #*
        '000000000000000', #+
        '000000000000000', #,
        '000000000000000', #-
        '000000000000000', #.
        '000000000000000', #/
        '111101101101111', #0
        '001001001001001', #1
        '111001111100111', #2
        '111001111001111', #3
        '101101111001001', #4
        '111100111001111', #5
        '111100111101111', #6
        '111001001001001', #7
        '111101111101111', #8
        '111101111001111', #9
        '000000000000000', #:
        '000000000000000', #;
        '000000000000000', #<
        '000000000000000', #=
        '000000000000000', #>
        '000000000000000', #?
        '0000000000', #@
        '0000000000', #A
        '0000000000', #B
        '0000000000', #C
        '0000000000', #D
        '0000000000', #E
        '0000000000', #F
        '0000000000', #G
        '0000000000', #H
        '0000000000', #I
        '0000000000', #J
        '0000000000', #K
        '0000000000', #L
        '0000000000', #M
        '0000000000', #N
        '0000000000', #O
        '0000000000', #P
        '0000000000', #Q
        '0000000000', #R
        '0000000000', #S
        '0000000000', #T
        '0000000000', #U
        '0000000000', #V
        '0000000000', #W
        '0000000000', #X
        '0000000000', #Y
        '0000000000', #Z
        '0000000000', #[
        '0000000000', #\
        '0000000000', #]
        '0000000000', #^
        '0000000000', #_
        '0000000000', #`
        '0000000000', #a
        '0000000000', #b
        '0000000000', #c
        '0000000000', #d
        '0000000000', #e
        '0000000000', #f
        '0000000000', #g
        '0000000000', #h
        '0000000000', #i
        '0000000000', #j
        '0000000000', #k
        '0000000000', #l
        '0000000000', #m
        '0000000000', #n
        '0000000000', #o
        '0000000000', #p
        '0000000000', #q
        '0000000000', #r
        '0000000000', #s
        '0000000000', #t
        '0000000000', #u
        '0000000000', #v
        '0000000000', #w
        '0000000000', #x
        '0000000000', #y
        '0000000000', #z
        '0000000000', #{
        '0000000000', #|
        '0000000000', #}
        '0000000000' #}~
]

# BITMAP 5x9 FONT
# ASCII Character Set 
bitmapFont5x9 = [
        '00000000000000000000000000000000000', #Space
        '00100001000010000100001000000000100', #!
        '01010010100000000000000000000000000', #"
        '01010010101101100000110110101001010', ##
        '00100011111000001110000011111000100', #$
        '11001110010001000100010001001110011', #%
        '01000101001010001000101011001001101', #&
        '10000100001000000000000000000000000', #'
        '00100010001000010000100000100000100', #(
        '00100000100000100001000010001000100', #)
        '00000001001010101110101010010000000', #*
        '00000001000010011111001000010000000', #+
        '000000000000000000000000000000110000100010000', #,
        '00000000000000011111000000000000000', #-
        '00000000000000000000000001100011000', #.
        '00001000010001000100010001000010000', #/
        '01110100011000110001100011000101110', #0
        '00100011000010000100001000010001110', #1
        '01110100010000101110100001000011111', #2
        '01110100010000101110000011000101110', #3
        '00010001100101011111000100001000010', #4
        '11111100001111000001000011000101110', #5
        '01110100001000011110100011000101110', #6
        '11111000010001000100010001000010000', #7
        '01110100011000101110100011000101110', #8
        '01110100011000101111000010000101110', #9
        '00000011000110000000011000110000000', #:
        '01100011000000001100011000010001000', #;
        '00010001000100010000010000010000010', #<
        '00000000001111100000111110000000000', #=
        '01000001000001000001000100010001000', #>
        '01100100100001000100001000000000100', #?
        '01110100010000101101101011010101110', #@
        '00100010101000110001111111000110001', #A
        '11110010010100111110010010100111110', #B
        '01110100011000010000100001000101110', #C
        '11110010010100101001010010100111110', #D
        '11111100001000011100100001000011111', #E
        '11111100001000011100100001000010000', #F
        '01110100011000010111100011000101110', #G
        '10001100011000111111100011000110001', #H
        '01110001000010000100001000010001110', #I
        '00111000100001000010000101001001100', #J
        '10001100101010011000101001001010001', #K
        '10000100001000010000100001000011111', #L
        '10001110111010110101100011000110001', #M
        '10001110011010110011100011000110001', #N
        '01110100011000110001100011000101110', #O
        '11110100011000111110100001000010000', #P
        '01110100011000110001101011001001101', #Q
        '11110100011000111110101001001010001', #R
        '01110100011000001110000011000101110', #S
        '11111001000010000100001000010000100', #T
        '10001100011000110001100011000101110', #U
        '10001100011000101010010100010000100', #V
        '10001100011000110101101011101110001', #W
        '10001100010101000100010101000110001', #X
        '10001100010101000100001000010000100', #Y
        '11111000010001000100010001000011111', #Z
        '01110010000100001000010000100001110', #[
        '10000100000100000100000100000100001', #\
        '00111000010000100001000010000100111', #]
        '00100010101000100000000000000000000', #^
        '00000000000000000000000000000011111', #_
        '11000110001000001000000000000000000', #`
        '00000000000111000001011111000101110', #a
        '10000100001011011001100011100110110', #b
        '00000000000011101000010000100000111', #c
        '00001000010110110011100011001101101', #d
        '00000000000111010001111111000001110', #e
        '00110010010100011110010000100001000', #f
        '000000000001110100011000110001011110000101110', #g
        '10000100001011011001100011000110001', #h
        '00100000000110000100001000010001110', #i
        '0001000000001100001000010000101001001100', #j
        '10000100001001010100110001010010010', #k
        '01100001000010000100001000010001110', #l
        '00000000001101010101101011010110101', #m
        '00000000001011011001100011000110001', #n
        '00000000000111010001100011000101110', #o
        '000000000001110100011000110001111101000010000', #p
        '000000000001110100011000110001011110000100001', #q
        '00000000001011011001100001000010000', #r
        '00000000000111110000011100000111110', #s
        '00100001000111100100001000010000111', #t
        '00000000001000110001100011001101101', #u
        '00000000001000110001100010101000100', #v
        '00000000001000110001101011010101010', #w
        '00000000001000101010001000101010001', #x
        '000000000010001100011000110001011110000101110', #y
        '00000000001111100010001000100011111', #z
        '00010001000010001000001000010000010', #{
        '00100001000010000000001000010000100', #|
        '01000001000010000010001000010001000', #}
        '01000101010001000000000000000000000' #}~
]

def make_text(text, x, y):
    graphics.set_font("bitmap6")
    graphics.set_pen(graphics.create_pen(255, 255, 255))
    graphics.text(text, x, y, -1, 1)


def print_char2x5(letter,xpos,ypos,size=1):
    graphics.set_pen(graphics.create_pen(255, 255, 255))

    origin = xpos
    charval = ord(letter)
    #print(charval)
    index = charval-32 #start code, 32 or space
    #print(index)
    character = bitmapFont2x5[index] #this is our char...
    rows = [character[i:i+2] for i in range(0,len(character),2)]
    #print(rows)
    for row in rows:
        #print(row)
        for bit in row:
            #print(bit)
            if bit == '1':
                graphics.pixel(xpos,ypos)
                if size==2:
                    graphics.pixel(xpos,ypos+1)
                    graphics.pixel(xpos+1,ypos)
                    graphics.pixel(xpos+1,ypos+1)
            xpos+=size
        xpos=origin
        ypos+=size

def print_char3x5(letter,xpos,ypos,size=1):
    graphics.set_pen(graphics.create_pen(255, 255, 255))

    origin = xpos
    charval = ord(letter)
    #print(charval)
    index = charval-32 #start code, 32 or space
    #print(index)
    character = bitmapFont3x5[index] #this is our char...
    rows = [character[i:i+3] for i in range(0,len(character),3)]
    #print(rows)
    for row in rows:
        #print(row)
        for bit in row:
            #print(bit)
            if bit == '1':
                graphics.pixel(xpos,ypos)
                if size==2:
                    graphics.pixel(xpos,ypos+1)
                    graphics.pixel(xpos+1,ypos)
                    graphics.pixel(xpos+1,ypos+1)
            xpos+=size
        xpos=origin
        ypos+=size
        
def print_char5x9(letter,xpos,ypos,size=1):
    graphics.set_pen(graphics.create_pen(255, 255, 255))

    origin = xpos
    charval = ord(letter)
    #print(charval)
    index = charval-32 #start code, 32 or space
    #print(index)
    character = bitmapFont5x9[index] #this is our char...
    rows = [character[i:i+5] for i in range(0,len(character),5)]
    #print(rows)
    for row in rows:
        #print(row)
        for bit in row:
            #print(bit)
            if bit == '1':
                graphics.pixel(xpos,ypos)
                if size==2:
                    graphics.pixel(xpos,ypos+1)
                    graphics.pixel(xpos+1,ypos)
                    graphics.pixel(xpos+1,ypos+1)
            xpos+=size
        xpos=origin
        ypos+=size


def print_string2x5(string,xpos,ypos,size=1):
    if size == 2:
        spacing = 6
    else:
        spacing = 3
    for i in string:
        print_char2x5(i,xpos,ypos,size)
        xpos+=spacing
        
def print_string3x5(string,xpos,ypos,size=1):
    if size == 2:
        spacing = 8
    else:
        spacing = 4
    for i in string:
        print_char3x5(i,xpos,ypos,size)
        xpos+=spacing
    
def print_string5x9(string,xpos,ypos,size=1):
    if size == 2:
        spacing = 12
    else:
        spacing = 6
    for i in string:
        print_char5x9(i,xpos,ypos,size)
        xpos+=spacing

cu.set_brightness(0.5)

paused = 0

while True:

    time_ms = time.ticks_ms()

    if cu.is_pressed(CosmicUnicorn.SWITCH_BRIGHTNESS_UP):
        cu.adjust_brightness(+0.01)

    if cu.is_pressed(CosmicUnicorn.SWITCH_BRIGHTNESS_DOWN):
        cu.adjust_brightness(-0.01)

    graphics.set_pen(graphics.create_pen(0, 0, 0))
    graphics.clear()

    text = "<--"
    timer_text = str(time_ms)[3:]
    if paused:
        timer_text = "0123456789"

    if cu.is_pressed(CosmicUnicorn.SWITCH_A):
        text = "A"

    if cu.is_pressed(CosmicUnicorn.SWITCH_B):
        text = "B"

    if cu.is_pressed(CosmicUnicorn.SWITCH_C):
        text = "Play"
        paused = 0

    if cu.is_pressed(CosmicUnicorn.SWITCH_D):
        text = "Pause"
        paused = 1

    if cu.is_pressed(CosmicUnicorn.SWITCH_VOLUME_UP):
        text = "Louder!"

    if cu.is_pressed(CosmicUnicorn.SWITCH_VOLUME_DOWN):
        text = "Quieter"

    if cu.is_pressed(CosmicUnicorn.SWITCH_BRIGHTNESS_UP):
        text = "Brighter!"

    if cu.is_pressed(CosmicUnicorn.SWITCH_BRIGHTNESS_DOWN):
        text = "Darker"

    if cu.is_pressed(CosmicUnicorn.SWITCH_SLEEP):
        text = "Zzz... zzz..."


    print_string2x5(timer_text, 0, 0)
    print_string3x5(timer_text, 0, 7)
    print_string5x9(timer_text, 0, 14)
    print_string5x9(text, 6, 22)
    print_char2x5("-",(time_ms // 1000) % 2,21)
    print_char2x5("-",(time_ms // 1000) % 2,23)
    cu.update(graphics)
